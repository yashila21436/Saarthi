<!DOCTYPE html>
<html data-bs-theme="light" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Projects - Brand</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800&amp;display=swap">
    <link rel="stylesheet" href="assets/css/bs-theme-overrides.css">
</head>

<style>
    .card-button {
        width: 100%; /* Makes the button expand to the full width of the card */
        margin-bottom: 0.5rem; /* Adds a little space below the button */
    }
    /* You can also add more styles to make it look even better */
</style>

<script>
    // Function to extract user details from URL query parameters
    function getUserDetails() {
        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get('ngoId');
        const userName = urlParams.get('ngoName');

        return { Id: userId, Name: userName };
    }

    function redirectToDashboard1() {
        const userDetails = getUserDetails();
        const aboutLink = `NGOdashboard.html?ngoId=${encodeURIComponent(userDetails.Id)}&ngoName=${encodeURIComponent(userDetails.Name)}`;
        return aboutLink;
    }
    // Function to dynamically generate link to About section with user details
    function generateAboutLink() {
        const userDetails = getUserDetails();
        const aboutLink = `about_ngo.html?ngoId=${encodeURIComponent(userDetails.Id)}&ngoName=${encodeURIComponent(userDetails.Name)}`;
        return aboutLink;
    }

    function generateProjectLink(){
        const userDetails = getUserDetails();
        const userLink = `projects_ngo.html?ngoId=${encodeURIComponent(userDetails.Id)}&ngoName=${encodeURIComponent(userDetails.Name)}`;
        return userLink;

    }

    function generateFaq(){
        const userDetails = getUserDetails();
        const userLink = `faq_html.html?ngoId=${encodeURIComponent(userDetails.Id)}&ngoName=${encodeURIComponent(userDetails.Name)}`;
        return userLink;

    }

    function generateindex(){
        const userDetails = getUserDetails();
        const userLink = `index_NGO.html?ngoId=${encodeURIComponent(userDetails.Id)}&ngoName=${encodeURIComponent(userDetails.Name)}`;
        return userLink;


    }
</script>
<body style="background: #19181d;">
<nav class="navbar navbar-expand-md sticky-top py-3 navbar-dark" id="mainNav" style="padding-right: 0px;margin-right: 1px;">
    <div class="container"><a class="navbar-brand d-flex align-items-center" href="index.html"><span class="bs-icon-sm bs-icon-circle bs-icon-primary shadow d-flex justify-content-center align-items-center me-2 bs-icon" style="background: var(--bs-body-bg);"><img src="assets/img/SAARTHI%20LOGO%201.png" width="33" height="33"></span><span>Saarthi</span></a><button data-bs-toggle="collapse" class="navbar-toggler" data-bs-target="#navcol-1"><span class="visually-hidden">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
        <div class="collapse navbar-collapse" id="navcol-1">
            <ul class="navbar-nav mx-auto">
                <li class="nav-item"><a class="nav-link" href="javascript:void(0)" onclick="location.href = generateindex()">Home</a></li>
                <li class="nav-item"><a class="nav-link" href="javascript:void(0)" onclick="location.href = generateAboutLink()">About</a></li>


                <li class="nav-item"><a class="nav-link active" href="javascript:void(0)" onclick="location.href = generateProjectLink()">Projects</a></li>
                <li class="nav-item"></li>
                <li class="nav-item"><a class="nav-link " href="javascript:void(0)" onclick="location.href = generateFaq()">FAQs</a></li>
                <li class="nav-item"></li>
                <li class="nav-item"></li>
                <li class="nav-item"></li>
            </ul><a onclick="location.href = redirectToDashboard1();" style="cursor: pointer; font-size: 34px; color: var(--bs-primary);">
            <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" style="font-size: 34px;color: var(--bs-primary);">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M16 9C16 11.2091 14.2091 13 12 13C9.79086 13 8 11.2091 8 9C8 6.79086 9.79086 5 12 5C14.2091 5 16 6.79086 16 9ZM14 9C14 10.1046 13.1046 11 12 11C10.8954 11 10 10.1046 10 9C10 7.89543 10.8954 7 12 7C13.1046 7 14 7.89543 14 9Z" fill="currentColor"></path>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 1C5.92487 1 1 5.92487 1 12C1 18.0751 5.92487 23 12 23C18.0751 23 23 18.0751 23 12C23 5.92487 18.0751 1 12 1ZM3 12C3 14.0902 3.71255 16.014 4.90798 17.5417C6.55245 15.3889 9.14627 14 12.0645 14C14.9448 14 17.5092 15.3531 19.1565 17.4583C20.313 15.9443 21 14.0524 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12ZM12 21C9.84977 21 7.87565 20.2459 6.32767 18.9878C7.59352 17.1812 9.69106 16 12.0645 16C14.4084 16 16.4833 17.1521 17.7538 18.9209C16.1939 20.2191 14.1881 21 12 21Z" fill="currentColor"></path>
            </svg>
        </a>
        </div>
    </div>
</nav>
<section class="py-5">
    <div class="container">
        <h2 class="fw-bold text-center text-white mb-4" style="font-size: 40px;"><strong>Available Projects</strong></h2>
        <div id="projectList" class="row g-4"></div>
    </div>
</section>

<footer class="bg-dark">
    <div class="container py-4 py-lg-5">
        <hr>
        <div class="text-muted d-flex justify-content-between align-items-center pt-3">
            <p class="mb-0">Copyright Â© 2024 by Aditi, Kanishk, Rahul &amp; Yashila</p>
            <ul class="list-inline mb-0"></ul>
        </div>
    </div>
</footer>

<!--<div class="modal fade" id="viewApplicationsModal" tabindex="-1" aria-labelledby="viewApplicationsLabel" aria-hidden="true">-->
<!--    <div class="modal-dialog modal-lg">-->
<!--        <div class="modal-content">-->
<!--            <div class="modal-header">-->
<!--                <h5 class="modal-title" id="viewApplicationsLabel">Project Applications</h5>-->
<!--                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>-->
<!--            </div>-->
<!--            <div class="modal-body" id="applicationsList">-->
<!--                &lt;!&ndash; Applications details will be dynamically added here &ndash;&gt;-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!-- Modal for Viewing All Applications -->
<div class="modal fade" id="viewApplicationsModal" tabindex="-1" aria-labelledby="viewApplicationsLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="viewApplicationsLabel">Project Applications</h5>
                <!-- Download to Excel Button -->

                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="applicationsList">
                <!-- Applications details will be dynamically added here -->
            </div>
        </div>
    </div>
</div>


<!-- Add this to your HTML file -->
<div id="updatingOverlay" class="updating-overlay">
    <div class="updating-message">Application status update is in process...</div>
</div>


<!-- Update Modal -->
<div class="modal" tabindex="-1" role="dialog" id="updateModal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Application Update</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Application status update is in process...</p>
            </div>
        </div>
    </div>
</div>

<!-- Modal to show applied students -->
<div class="modal fade" id="appliedStudentsModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Applied Students</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="appliedStudentsList">
                <!-- Applied students will be dynamically added here -->
            </div>
        </div>
    </div>
</div>
<script src="assets/bootstrap/js/bootstrap.min.js"></script>
<script src="assets/js/bold-and-dark.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>


<script>


    function viewApplications(jobId) {
        console.log('Fetching applications for job ID:', jobId);
        const applicationsList = document.getElementById('applicationsList');
        applicationsList.innerHTML = 'Loading...'; // Placeholder, replace with fetch logic
        fetch(`http://localhost:3000/applications?jobId=${jobId}`) // Make a request to fetch applications
            .then(response => response.json())
            .then(applicationsData => {
                applicationsList.innerHTML = ''; // Clear existing content

                if (applicationsData.length === 0) {
                    applicationsList.innerHTML = 'No applications yet.';
                } else {
                    applicationsData.forEach(application => {
                        // Create HTML elements to display student details
                        const card = document.createElement('div');
                        card.classList.add('card', 'mb-3');
                        card.innerHTML = `
                        <div class="card-body">
                            <h5 class="card-title">${application.student_name}</h5>
                            <p class="card-text">Skills: ${application.skills}</p>
                            <p class="card-text">Email: ${application.email_id}</p>
                            <p class="card-text">Status: ${application.status}</p>
                            <button class="btn btn-success" onclick="acceptApplication(${jobId}, ${application.student_id})">Accept</button>
                            <button class="btn btn-danger" onclick="rejectApplication(${jobId}, ${application.student_id})">Reject</button>

                        </div>
                    `;
                        applicationsList.appendChild(card);
                    });
                }
            })
            .catch(error => {
                console.error('Failed to fetch applications:', error);
                applicationsList.innerHTML = 'Error loading applications.';
            });
        new bootstrap.Modal(document.getElementById('viewApplicationsModal')).show();
    }

    // function acceptApplication(applicationId, studentId) {
    //     console.log('applicationId:', applicationId);
    //     console.log('studentId:', studentId);
    //     fetch('http://localhost:3000/update-application-status', {
    //         method: 'post',
    //         action: 'http://localhost:3000/update-application-status',
    //         headers: { 'Content-Type': 'application/json' },
    //         body: JSON.stringify({ applicationId: applicationId, studentId: studentId, status: 'Accepted by NGO' })
    //     })
    //         .then(response => {
    //             if (!response.ok) { // Check if the request was successful
    //                 throw new Error('Network response was not ok');
    //             }
    //             return response.json(); // If successful, parse the response
    //         })
    //         .then(() => {
    //             // UI Update - Example using DOM manipulation
    //             const applicationElement = document.getElementById(`application-${applicationId}`);
    //             if (applicationElement) {
    //                 applicationElement.querySelector('.card-text:last-of-type').textContent = 'Status: Accepted by NGO';
    //                 // Optionally, you can remove the buttons or visually update their state
    //             }
    //         })
    //         .catch(error => {
    //             console.error('Failed to accept application:', error);
    //             alert('There was an error updating the application status.'); // User Feedback
    //         });
    // }
    // function acceptApplication(applicationId, studentId) {
    //     console.log('applicationId:', applicationId);
    //     console.log('studentId:', studentId);
    //
    //     // Optimistically update the UI to inform the user that the status is being updated
    //     const applicationElement = document.getElementById(`application-${applicationId}`);
    //     if (applicationElement) {
    //         applicationElement.querySelector('.card-text:last-of-type').textContent = 'Status: Updating...';
    //         // Optionally, you can disable the buttons to prevent multiple clicks
    //     }
    //
    //     fetch('http://localhost:3000/update-application-status', {
    //         method: 'post',
    //         headers: { 'Content-Type': 'application/json' },
    //         body: JSON.stringify({ applicationId: applicationId, studentId: studentId, status: 'Accepted by NGO' })
    //     })
    //         .then(response => {
    //             if (!response.ok) { // Check if the request was successful
    //                 throw new Error('Network response was not ok');
    //             }
    //             return response.json(); // If successful, parse the response
    //         })
    //         .then(() => {
    //             // Update the UI to reflect the confirmed status update
    //             if (applicationElement) {
    //                 applicationElement.querySelector('.card-text:last-of-type').textContent = 'Status: Accepted by NGO';
    //                 // Optionally, you can update the buttons' state or hide them
    //             }
    //         })
    //         .catch(error => {
    //             console.error('Failed to accept application:', error);
    //             // If there's an error, inform the user that the status will be updated soon
    //             if (applicationElement) {
    //                 applicationElement.querySelector('.card-text:last-of-type').textContent = 'Status: Will be updated soon...';
    //             }
    //         });
    // }
    function acceptApplication(applicationId, studentId) {
        console.log('applicationId:', applicationId);
        console.log('studentId:', studentId);

        // Optimistically update the UI to show a progress message
        const applicationElement = document.getElementById(`application-${applicationId}`);
        if (applicationElement) {
            applicationElement.querySelector('.card-text:last-of-type').textContent = 'Status: Updation in progress...';
        }

        fetch('http://localhost:3000/update-application-status', {
            method: 'post',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ applicationId: applicationId, studentId: studentId, status: 'Accepted by NGO' })
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(() => {
                // Update the UI with the final status
                viewApplications(applicationId);
            })
            .catch(error => {
                console.error('Failed to accept application:', error);
                if (applicationElement) {
                    applicationElement.querySelector('.card-text:last-of-type').textContent = 'Status: Update failed. Please try again.';
                }
            });
    }



    function rejectApplication(applicationId, studentId) {
        console.log('applicationId:', applicationId);
        console.log('studentId:', studentId);

        // Optimistically update the UI to show a progress message
        const applicationElement = document.getElementById(`application-${applicationId}`);
        if (applicationElement) {
            applicationElement.querySelector('.card-text:last-of-type').textContent = 'Status: Updation in progress...';
        }

        fetch('http://localhost:3000/update-application-status', {
            method: 'post',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ applicationId: applicationId, studentId: studentId, status: 'Rejected' })
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(() => {
                // Update the UI with the final status
                viewApplications(applicationId);
            })
            .catch(error => {
                console.error('Failed to accept application:', error);
                if (applicationElement) {
                    applicationElement.querySelector('.card-text:last-of-type').textContent = 'Status: Update failed. Please try again.';
                }
            });
    }

    // function viewApplications(projectId) {
    //     const applicationsList = document.getElementById('applicationsList');
    //     applicationsList.innerHTML = 'Loading...'; // Show loading text
    //
    //     fetch(`http://localhost:3000/applications?projectId=${projectId}`)
    //         .then(response => response.json())
    //         .then(applications => {
    //             applicationsList.innerHTML = ''; // Clear loading text
    //             if (applications.length === 0) {
    //                 applicationsList.innerHTML = '<p>No applications found.</p>';
    //             } else {
    //                 applications.forEach(app => {
    //                     applicationsList.innerHTML += `
    //                     <div class="card bg-dark text-white mb-2">
    //                         <div class="card-body">
    //                             <h5 class="card-title">${app.student_name}</h5>
    //                             <p class="card-text">Skills: ${app.skills}</p>
    //                             <p class="card-text">Email: ${app.email_id}</p>
    //                         </div>
    //                     </div>
    //                 `;
    //                 });
    //             }
    //         })
    //         .catch(error => {
    //             console.error('Failed to fetch applications:', error);
    //             applicationsList.innerHTML = '<p>Error loading applications.</p>';
    //         });
    // }



    function deleteProject(jobId) {
        if (confirm('Are you sure you want to delete this project?')) {
            console.log('Deleting project with job ID:', jobId);

            // Show the updating overlay
            const updatingOverlay = document.getElementById('updatingOverlay');
            updatingOverlay.style.display = 'block';

            fetch(`http://localhost:3000/projectsdel/${jobId}`, {
                method: 'DELETE', // Use the DELETE HTTP method
                headers: { 'Content-Type': 'application/json' }
                // No body is needed for a delete request
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(() => {
                    console.log('Project deleted successfully.');
                    window.location.reload(); // Reload the entire page
                })
                .catch(error => {
                    console.error('Failed to delete project:', error);
                    alert('There was an error deleting the project. Please try again.');
                })
                .finally(() => {
                    // Hide the updating overlay regardless of the outcome
                    updatingOverlay.style.display = 'none';
                });
        }
    }

    function downloadApplicationsExcel(jobId) {
        // Assuming jobId is available globally or needs to be fetched dynamically
        // Example jobId fetch, replace with actual method if different
         // Ensure you have a way to get the current jobId visible in the modal
        window.location.href = `http://localhost:3000/download-applications?jobId=${jobId}`;
    }



    function viewFinalApplications(jobId) {
        // Fetch and display the final applicants
        console.log('Fetching final applicants for job ID:', jobId);
        const applicationsList = document.getElementById('applicationsList');
        applicationsList.innerHTML = 'Loading...'; // Placeholder, show loading status

        fetch(`http://localhost:3000/final-applications?jobId=${jobId}`)
            .then(response => response.json())
            .then(finalApplicationsData => {
                const applicationsList = document.getElementById('applicationsList');
                applicationsList.innerHTML = ''; // Clear existing content

                if (finalApplicationsData.length === 0) {
                    applicationsList.innerHTML = 'No final applicants yet.';
                } else {
                    finalApplicationsData.forEach(application => {
                        // Create HTML elements to display student details
                        const card = document.createElement('div');
                        card.classList.add('card', 'mb-3');
                        card.innerHTML = `
                        <div class="card-body">
                            <h5 class="card-title">${application.student_name}</h5>
                            <p class="card-text">Skills: ${application.skills}</p>
                            <p class="card-text">Email: ${application.email_id}</p>
                            <p class="card-text">Status: ${application.status}</p>
                            <button class="btn btn-success" onclick="updateApplicationStatus(${jobId}, ${application.student_id}, 'Satisfactory')">Satisfactory</button>
                            <button class="btn btn-danger" onclick="updateApplicationStatus(${jobId}, ${application.student_id}, 'Unsatisfactory')">Unsatisfactory</button>

                        </div>

                    `;
                        applicationsList.appendChild(card);
                    });
                }
            })
            .catch(error => {
                console.error('Failed to fetch final applications:', error);
                applicationsList.innerHTML = 'Error loading final applicants.';
            });
        // Display the modal
        new bootstrap.Modal(document.getElementById('viewApplicationsModal')).show();
    }

    function updateApplicationStatus(projectId, studentId, status) {
        fetch('http://localhost:3000/update-project-status-final', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                projectId: projectId,
                studentId: studentId,
                status: status
            })
        })
            .then(response => response.json())
            .then(data => {
                alert(`Status updated to ${status}`);
                // Optionally refresh or update the UI to reflect the new status
            })
            .catch(error => {
                console.error('Error updating application status:', error);
                alert('Failed to update application status. Please try again.');
            });
    }


    function viewAllApplications(projectId) {
        console.log('Fetching all applications for project ID:', projectId);
        const applicationsList = document.getElementById('applicationsList');
        applicationsList.innerHTML = 'Loading applications...'; // Display a loading message

        fetch(`http://localhost:3000/all-applications?projectId=${projectId}`)
            .then(response => response.json())
            .then(applications => {
                applicationsList.innerHTML = ''; // Clear loading message
                if (applications.length === 0) {
                    applicationsList.innerHTML = '<p>No applications found for this project.</p>';
                } else {
                    applications.forEach(app => {
                        const card = document.createElement('div');
                        card.className = 'card bg-secondary text-white mb-2';
                        card.innerHTML = `
                        <div class="card-body">
                            <h5 class="card-title">${app.student_name}</h5>
                            <p class="card-text">Skills: ${app.skills}</p>
                            <p class="card-text">Status: ${app.status}</p>
                            <p class="card-text">Email: ${app.email_id}</p>
                        </div>
                    `;
                        applicationsList.appendChild(card);
                    });
                }
                // Display the modal
                new bootstrap.Modal(document.getElementById('viewApplicationsModal')).show();
            })
            .catch(error => {
                console.error('Failed to fetch all applications:', error);
                applicationsList.innerHTML = 'Error loading applications.';
            });
    }

    // function viewAllApplications(jobId) {
    //     const applicationsList = document.getElementById('applicationsList');
    //     applicationsList.innerHTML = 'Loading applications...';
    //     fetch(`http://localhost:3000/all-applications?projectId=${jobId}`)
    //         .then(response => response.json())
    //         .then(applications => {
    //             applicationsList.innerHTML = '';
    //             applications.forEach(app => {
    //                 const card = document.createElement('div');
    //                 card.className = 'card bg-secondary text-white mb-2';
    //                 card.innerHTML = `
    //                 <div class="card-body">
    //                     <h5 class="card-title">${app.student_name}</h5>
    //                     <p class="card-text">Skills: ${app.skills}</p>
    //                     <p class="card-text">Email: ${app.email}</p>
    //                 </div>
    //             `;
    //                 applicationsList.appendChild(card);
    //             });
    //             // Show the modal after data is loaded
    //             $('#viewApplicationsModal').modal('show');
    //         })
    //         .catch(error => {
    //             console.error('Error loading applications:', error);
    //             applicationsList.innerHTML = 'Failed to load applications.';
    //         });
    // }
    //



    window.onload = function () {
        const urlParams = new URLSearchParams(window.location.search);
        const ngoId = urlParams.get('ngoId');
        fetch(`http://localhost:3000/projects?ngoId=${ngoId}`)
            .then(response => response.json())
            .then(projectsData => {
                const projectList = document.getElementById("projectList");
                projectList.innerHTML = ''; // Clear existing entries
                if (projectsData.length === 0) {
                    projectList.innerHTML = '<p class="text-white text-center">No projects available.</p>';
                } else {
                    projectsData.forEach(project => {
                        const card = document.createElement("div");
                        card.className = "col-md-4";
                        card.innerHTML = `
                                <div class="card h-100 bg-dark text-white">
                                    <div class="card-body">
                                    <h5 class="card-title"><strong>${project.project_name}</strong></h5>
                                    <p class="card-text">${project.about_ngo}</p>
                                    <p class="card-text"><strong>Duration:</strong> ${project.duration}</p>
                                    <p class="card-text"><strong>Skills Required:</strong> ${project.required_skills}</p>
                                    <p class="card-text"><strong>Contact:</strong> ${project.contact}</p>

                                    <button class="btn btn-success card-button" onclick="viewFinalApplications(${project.job_id})">View Final Applicants</button>
                                    <button class="btn btn-primary card-button" onclick="viewApplications(${project.job_id})">View Applications</button>
                                    <button class="btn btn-info card-button" onclick="viewAllApplications(${project.job_id})">View All Applications</button>

                                    <button class="btn btn-danger card-button" onclick="deleteProject(${project.job_id})">Delete Project</button>
                                    <button class="btn btn-warning card-button" onclick="downloadApplicationsExcel(${project.job_id})">Download to Excel</button>
                                    ${project.status === 0 ? '<span class="badge bg-secondary">Closed</span>' : '<button class="btn btn-warning card-button" onclick="closeProject(' + project.job_id + ')">Close Project</button>'}
                                </div>
                                </div>
                            `;
                        projectList.appendChild(card);
                    });
                }
            })
            .catch(error => {
                console.error('Failed to fetch projects:', error);
                projectList.innerHTML = '<p class="text-white text-center">Error loading projects.</p>';
            });
    };

    function closeProject(jobId) {
        if (confirm('Are you sure you want to close this project? This action cannot be undone.')) {
            fetch(`http://localhost:3000/close-project/${jobId}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to close the project');
                    }
                    return response.json();
                })
                .then(() => {
                    alert('Project has been successfully closed.');
                    window.location.reload(); // Reload the page to reflect changes
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error closing project. Please try again.');
                });
        }
    }

</script>

</body>
</html>